<?php
require($_SERVER["DOCUMENT_ROOT"]."/bitrix/php_interface/third_party/facebook/facebook.php");
$facebook = new Facebook(array(
  'appId'  => '225734987442328',
  'secret' => 'fdd11ce78685fef2a0de260fab387302',
  'cookie' => false,
));

$session = $facebook->getSession();
?><?
require($_SERVER["DOCUMENT_ROOT"]."/bitrix/modules/main/include/prolog_before.php");
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
<link rel="stylesheet" type="text/css" media="screen" href="http://www.luxoft-training.ru/bitrix/templates/en/template_styles.css" />


<meta http-equiv="Content-Type" content="text/html; charset=windows-1251" />
-->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6/jquery.min.js"></script>
<body>
<div id="fb-root"></div>
<script src="http://connect.facebook.net/en_US/all.js"></script>
<script type="text/javascript">
  window.fbAsyncInit = function() {
    FB.init({appId: '203360106364151', status: false, cookie: false, xfbml: true});
  window.setTimeout(function() {
    FB.Canvas.setAutoResize();
  }, 250);
  };
  (function() {
    var e = document.createElement('script');
    e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
    e.async = true;
    document.getElementById('fb-root').appendChild(e);
  }());
</script>
<style>
* { margin: 0; padding: 0; }
body { margin: 0; padding: 0; border: 0; }
#container {
    width: 960px;
    margin: 0 0 0 0;
    padding: 0 0 0 0;
    text-align: left;
    position: absolute;
    left: 0;
}
#header { height: 94px; }
#content {
    width: 960px;
    padding: 0 0 0 20px;
    margin: 0 0 0 0;
    min-height: 500px;
}
#content ul { margin: 0 0 10px 20px; }
#content li { margin-bottom: 2px; }

body {
    text-align: left;
    font-family: Arial, Helvetica, sans-serif;
    font-size: 12px;
    background: url(/bitrix/templates/en/images/background.jpg) #FFFFFF no-repeat scroll right top;
}
.clear { clear: both; }
.l { float: left; }
.r { float: right; }
ol { margin: 0 0 10px 45px; }
.bx-core-dialog div.r, .bx-core-dialog div.l { float: none; }
.tocenter{ text-align: center; }
.toright{ text-align: right; }
.w350 { width: 350px; }
.w360 { width: 360px; }
.w370 { width: 370px; }
.w200 { width: 200px; }
.w420 { width: 420px; }
.w500 { width: 500px; }
.w540 { width: 540px; }
.w545 { width: 545px; }
.w445 { width: 445px; }
.w600 { width: 600px; }
.w100 { width: 100px; }
.w80 { width: 80px; }
.w50 { width: 50px; }
.w65 { width: 65px; }
.w60 { width: 60px; }
.w280 { width: 280px; }
.w260 { width: 260px; }
.nobr { white-space: nowrap; }
.st { font-weight: bold; }
.edu { }
table.edu a.orange:active { color: #FC711B!important; }
table.edu a.orange:link { color: #FC711B!important; }
table.edu a.orange:visited { color: #FC711B!important; }
table.edu a.blue:active { color: #00528D!important; }
table.edu a.blue:link { color: #00528D!important; }
table.edu a.blue:visited { color: #00528D!important; }
.botborder {
    height: 1px;
    border-bottom: 1px #CCC solid;
    margin: 5px 0 10px 0;
}
.botborder_no_indent {
    margin: 0 0 10px;
    height: 1px;
    border-bottom: 1px #CCC solid;
}
.important{
    color: #C90404;
    font-size: 15px;
    margin: 0 0 5px 10px;
    display: block;
}
.important a{
    text-decoration: underline;
    color: #C90404;
    font-size: 15px;
}
.goaway{
    padding-right: 9px;
    background: transparent url(http://www.luxoft.com/images_new/bg-author-link.gif) no-repeat center right;
}
.bb { border: 1px #000 solid; }
.auto { overflow: hidden; }
a.orange:link, a.orange:visited { color: #FC711B; text-decoration: underline; }
a.black:link, a.black:visited { color: #000; text-decoration: underline; }
.justify_text{ text-align: justify!important; }
.registration{
    color: #888888;
    font-size: 14px;
    padding-bottom: 10px;
    display: block;
}
.posrel{ position: relative; }
.posabs{ position: absolute; }
h3.red { color: #AA0000; font-size: 12px; }
h3.black { color: #000000; font-size: 12px; }
a { color: #00528D; text-decoration: none; }
a:hover { text-decoration: underline; color: #C90404; }
a img { border: none; }
ul { padding: 0; margin: 0 0 0 0; }
ul.indent { margin: 0 0 0 50px; }
p.indent { margin: 0 0 0 40px; }
div.indent { margin: 0 0 0 40px; }
div.indent ul{
    list-style-image: url(/bitrix/templates/en/images/list_index_bigger_no_up.gif);
    list-style-position: outside;
    list-style-type: circle;
    margin: 0 0 0 25px;
}
div.indent blockquote{ margin: 0 0 0 0; }
h1, h2, h3, h4 { font-family: Arial, serif; margin: 0; }
h1{ color: #1C3377; font-size: 18px; margin: 0; padding: 0; }
h2 { padding: 0 0 5px 0; font-size: 14px; color: #22396D; }
h3 { padding: 0; font-size: 12px; }
h2 a:hover, h3 a:hover { color: #C90404; text-decoration: none; }
h2.underline a:hover, h3.underline a:hover { color: #C90404; text-decoration: underline; }
p {
    padding: 0 20px 10px 0;
    color: #000000;
    text-align: left;
    line-height: 140%;
}
p.right { text-align: right; }
p.center { text-align: center; }
label { color: #000000; font-weight: bold; }
blockquote { margin: 0 0 0 25px; line-height: 140%; }
blockquote ul {
    list-style: circle url(/bitrix/templates/en/images/list_index_bigger_no_up.gif) outside;
    margin: 0 0 10px 20px;
}
blockquote ul li { }
#content blockquote ul  ul {
    list-style: circle url(/bitrix/templates/en/images/list_index_empty.gif) outside;
    margin: 5px 0 10px 40px;
}
blockquote ul  ul {
    list-style: circle url(/bitrix/templates/en/images/list_index_empty.gif) outside;
    margin: 5px 0 10px 40px;
}
#content blockquote blockquote  ul {
    list-style: circle url(/bitrix/templates/en/images/list_index_empty.gif) outside;
    margin: 5px 0 10px 30px;
}
blockquote blockquote  ul {
    list-style: circle url(/bitrix/templates/en/images/list_index_empty.gif) outside;
    margin: 5px 0 10px 30px;
}
#content blockquote ul  ol { margin: 5px 0 10px 40px; }
blockquote ul  ol { margin: 5px 0 10px 40px; }
input, textarea { color: #404040; vertical-align: middle; }
#content li { line-height: 140%; }
#content ul { margin: 0 0 0 20px; }
    /*************** NEWS BLOCK STYLES ***********************************************************************************************************/


table.edu {
    width: 100%;
    margin-bottom: 10px;
    border-collapse: collapse;
    margin: 0 auto 15px auto;
    line-height: 100%;
}
table.edu a:visited { color: #FC711B; }
table.edu .edu_header { background-color: #22396D; }
table.edu a:active { color: #FC711B; }
table.edu a:link { color: #FC711B; }
table.edu h3 { color: #FFFFFF; font-size: 12px; padding: 0; }
    /* main table row color */
.ewTableRow { background-color: #FFFFFF; /* alt row color 1 */ }
    /* main table highlight color */
.ewTableHighlightRow { background-color: #E9ECF2; /* highlight color */ }
.ewTableAltRow { background-color: #FFFFFF; /* alt row color 2 */ }
    /* main table select color */
.ewTableSelectRow { background-color: #FFDEB9; /* select color */ }
table.edu th { vertical-align: middle; color: #E9ECF2; }
table.edu p { padding: 0; }
table.edu .edu_header p { color: #FFFFFF; }
table.edu td {
    border: 1px #C4C3CB solid;
    padding: 5px;
    vertical-align: top;
    line-height: 130%;
}
table.edu ul { padding: 0; margin: 0 0 0 5px; }
table.edu li { padding: 0; margin: 0 0 10px 5px; }
table.edu tr.select { padding: 0; margin: 0 0 10px 5px; }
table.edu td.td_code p { color: #6B6B6B; }
table.edu td.td_name { }
table.edu td.td_date { }
table.edu td.td_duration { }
table.edu td.td_price { }
table.edu td.td_time { }
    /* ----------- ru site  --> edu   ENDS ----------- */
table.e-com td { border-bottom: 1px solid #EEEEEE; }
table.e-com tbody { margin: 0; padding: 0; }
table.e-com td.logo { padding: 5px; }
table.e-com td.logo img { border: none; }
table.e-com td.partner { padding: 0 0 0 20px; }
.links {
    padding: 0 0 0 15px;
    background: url(/images_new/bgr_arr_1.gif) no-repeat top left;
}
.header_links {
    margin: 0 7px;
    padding: 0 0 2px 10px;
    background: url(/images_new/bgr_arr_1.gif) no-repeat top left;
}
span.links div{ }
span.links div div{ }
img.ggl { float: left; padding: 3px 5px 3px 0; }
.autowidth{ width: auto!important; }
div.team_member_new {
    margin: 0 0 10px 0;
    padding: 10px 10px 20px 10px;
    color: #8E9BB7;
    border-bottom: 1px solid #eee;
    clear: both;
}
div.team_member_new a { text-decoration: none; }
div.team_member_new img {
    float: left;
    width: 50px;
    height: 50px;
    margin: 0 10px 40px 0;
    border: none;
}
div.team_member_new p { margin: 0; padding: 0; }
div.team_member_new div.about {
    clear: both;
    padding: 10px;
    margin: 10px 0 0 60px;
    color: #000;
    border: 1px solid #fff;
}
div.headline_image td {
    width: 30%;
    vertical-align: top;
    padding: 0 0 15px 0;
    color: #eee;
}
div.headline_image td img {
    width: 50px;
    height: 50px;
    float: left;
    margin: 0 10px 0 0;
}
div.headline_image td a {
    font-size: 100%;
    font-weight: bold;
    margin: 0;
    padding: 0;
    color: #fff;
}
div.bx-debug-summary { position: relative; }
.image_left { float: left; padding: 2px 15px 10px 0; }
.image_left_m { float: left; margin: 2px 15px 10px 0; }
.image_right { float: right; padding: 2px 0 10px 15px; }
.floated_right {
    background-color: #F9F9F7;
    float: right;
    font-size: 110%;
    margin: 0 0 10px 20px;
    padding: 15px;
}
.floated_right_nc {
    float: right;
    font-size: 100%;
    margin: 0 0 10px 20px;
    padding: 15px;
}
.usual { margin: 0 auto; padding: 0 0 15px 0; }
.usual div.inside {
    border: 1px solid #C4C3CB;
    clear: left;
    overflow: auto;
    padding: 10px  20px 10px  20px;
}
.ie .usual ul.idtabs { border: 1px solid #fff; }
.usual div.inside table.edu td {
    border: 0 solid #C4C3CB;
    border-bottom: 1px solid #C4C3CB;
}
.usual div.inside table.edu tr.header td { border-bottom: 0 solid #C4C3CB; }
.usual ul.idtabs li { list-style: none; float: left; }
.usual ul.idtabs a {
    display: block;
    text-decoration: none!important;
    color: #000;
    border-left: 1px solid #C4C3CB;
    border-top: 1px solid #C4C3CB;
    border-right: 1px solid #C4C3CB;
    padding: 7px 19px;
    margin: 2px -1px 0 0;
    font-weight: bold;
    font-size: 13px;
}
#content .usual ul.idtabs { margin: 0 0 0 0; }
.usual ul.idtabs a.selected {
    cursor: default;
    margin-bottom: -1px;
    position: relative;
    z-index: 0;
    border-bottom: 1px solid #FFFFFF;
    color: #6C6A7B;
}
#content .usual ul.idtabs li { margin-bottom: 0; }
.ie .usual ul.idtabs a.last_li { margin-right: 0; }
.ie .usual ul.idtabs a.selected {
    border-top: 1px solid #C4C3CB;
    border-bottom: 1px solid #fff;
    height: 17px;
}
.cities ul li {
    float: left;
    margin: 10px;
    padding: 10px;
    border: 0 none;
    display: block;
    float: left;
    font-size: 110%;
    margin: 0 7px 0 0;
    padding: 0;
    position: relative;
}
#content .cities ul { border: 0 none; display: block; margin: 0; padding: 0; }
.cities ul li a {
    color: #22396D;
    display: block;
    height: 26px;
    line-height: 26px;
    text-decoration: none;
    padding: 0 6px;
    background-color: #939DB6;
    color: #FFFFFF;
}
.cities ul li a.selected {
    background-color: #C85711;
    color: #FFFFFF;
    font-weight: normal;
    padding: 0 6px;
}
.cities ul li a:hover { background-color: #C85711; color: #FFFFFF; }
.cities ul li a.without {
    background-color: none;
    color: #6C6A7B;
    cursor: default;
    display:none;
}
.cities ul li a.without:hover {
    background-color: transparent;
    color: #6C6A7B;
    cursor: default;
}
#showcalendar div.inside { background-color: #E9ECF2; }
#showcalendar  div.inside { padding: 10px 13px; }
#showcalendar  ul.idtabs a.selected {
    border-bottom: 1px solid #E9ECF2;
    color: #6C6A7B;
    background-color: #E9ECF2;
}
#showcalendar  ul.idtabs { position: relative; }
.block_border{
    border: 0 solid #fff;
    margin: 10px 0;
    padding: 10px 0 0 0;
    overflow: auto;
}
.wrapper{ padding: 7px 0 10px 10px; }
.training_code { color: #6B6B6B; }
#showcalendar table.edu .edu_header { background-color: #22396D; }
#showcalendar  table.edu a:link,  #showcalendar  table.edu a:visited{ color: #00528D; }
#showcalendar  table.edu a:hover{ text-decoration: underline; }
#showcalendar .ewTableAltRow { background-color: #E9ECF2; }
#showcalendar .ewTableRow { background-color: #E9ECF2; }
#showcalendar .ewTableHighlightRow { background-color: #fff; }
input.email_form {
    border: 1px solid #7F9DB9;
    font-family: Arial,Helvetica,sans-serif,Tahoma,Verdana;
    font-size: 12px;
    height: 15px;
    margin-bottom: 3px;
    margin-right: 0;
    padding: 2px;
    width: 160px;
}
.vert_indent{ margin: 0 0 4px 0; }
.form-required, .starrequired{ color: red; }
.tooltip{
    background-color: #22396D;
    border: 1px solid #FFFFFF;
    box-shadow: 0 0 10px #000000;
    color: #FFFFFF;
    display: block;
    font-size: 12px;
    padding: 8px;
    width: 200px;
    display: none;
    min-height: 50px;
    -moz-border-radius: 7px;
    -webkit-border-radius: 7px;
    border-radius: 7px; /* future proofing */
    -khtml-border-radius: 7px; /* for old Konqueror browsers */
    line-height: 130%;
    text-align: left;
}
a.show_tooltip{
    border-bottom: 1px dashed #00528D;
    text-decoration: none;
    cursor: pointer;
}
a{ text-decoration: none; }
a.show_tooltip:hover {
    border-bottom: 1px dashed #C90404;
    text-decoration: none!important;
}




body {
        width:500px;
        margin:0;
        padding:0;
        border:0;
        font-size: 11px;
        background: none repeat scroll 0 0 #FFFFFF!important;
    }
    .f_query_state {
        height: 190px;
    }

    table.edu {
        font-size: 11px;
    }
    table.edu td.td_buy,table.edu td.td_time ,table.edu td.td_code{
        display:none;
    }
    .edu_sort{
        display:none;
    }
    h2.abs{
        position:relative!important;
    }
    .cities ul li a {
        font-size: 14px;
    }
    .cities ul li {
        margin: 0 2px 4px 0;
    }

    .cities ul li a {
        padding: 0 6px;
    }

</style>






<?
$id_city ="5741"; //Москва
if (isset($_GET["city"])) {
		switch ($_GET["city"]) {
		    case "moscow":
		        $id_city ="5741";
		        break;
		    case "omsk":
		        $id_city ="5742";
		        break;
		    case "spb":
		        $id_city ="5744";
		        break;
		    case "kiev":
		        $id_city ="5745";
		        break;
		    case "odessa":
		        $id_city ="5746";
		        break;
		    case "dnepr":
		        $id_city ="5747";
		        break;
		  	case "online":
		        $id_city ="14909";
		        break;
		}
 }

$APPLICATION->SetPageProperty("id_city", $id_city);

$id_type = 2;    //курсы
$bOnline = false;
$ID_IBLOCK = 9;
if (isset($_GET["type"])) {
		switch ($_GET["type"]) {
		    case "courses":
		        $id_type = 2;
		        $ID_IBLOCK = 9;
		        break;
		    case "events":
		        $id_type =3;
		        $ID_IBLOCK = 65;
		        break;
		    case "schools":
		        $id_type =1;
		        break;
		    case "online":
		        $id_type =4;
		        break;
		}
 }

if (isset($_GET["online"])) {
	$bOnline  = true;
}
//echo "$bOnline =bOnline";
/* поиск колв-ва */


			// создаем объект
			$obCache = new CPHPCache;
			// время кеширования - 30 минут
			$life_time = 5*60;
			// формируем идентификатор кеша в зависимости от всех параметров
			// которые могут повлиять на результирующий HTML
			$cache_id = 9743;

			// если кеш есть и он ещё не истек, то
			if($obCache->InitCache($life_time, $cache_id, "/")) {
				// получаем закешированные переменные
				$vars = $obCache->GetVars();
				$sch_in_moscow = $vars["sch_in_moscow"];
				$sch_in_omsk = $vars["sch_in_omsk"];
				$sch_in_spb = $vars["sch_in_spb"];
				$sch_in_kiev = $vars["sch_in_kiev"];
				$sch_in_odessa = $vars["sch_in_odessa"];
				$sch_in_dnepr = $vars["sch_in_dnepr"];
				$sch_in_online = $vars["sch_in_online"];
				$res_in_moscow = $vars["res_in_moscow"];
				$res_in_omsk = $vars["res_in_omsk"];
				$res_in_spb = $vars["res_in_spb"];
				$res_in_kiev = $vars["res_in_kiev"];
				$res_in_odessa = $vars["res_in_odessa"];
				$res_in_dnepr = $vars["res_in_dnepr"];
				$res_in_online = $vars["res_in_online"];
				// иначе обращаемся к базе
			} else {?>
		<?if(CModule::IncludeModule("iblock")) {
			$arGroupBy  = Array();$arOrder = Array();
	      	$arSelectFields = Array("ID");
			$arFilter = Array("IBLOCK_ID"=>10, "ACTIVE"=>"Y", "PROPERTY_city"=>5741, ">=PROPERTY_startdate" => ConvertDateTime(date($DB->DateFormatToPHP(CSite::GetDateFormat("SHORT")), time()), "YYYY-MM-DD", "ru"));
			$sch_in_moscow = CIBlockElement::GetList($arOrder, $arFilter, $arGroupBy, false, $arSelectFields);
			$arFilter = Array("IBLOCK_ID"=>10, "ACTIVE"=>"Y", "PROPERTY_city"=>5742, ">=PROPERTY_startdate" => ConvertDateTime(date($DB->DateFormatToPHP(CSite::GetDateFormat("SHORT")), time()), "YYYY-MM-DD", "ru"));
			$sch_in_omsk = CIBlockElement::GetList($arOrder, $arFilter, $arGroupBy, false, $arSelectFields);
			$arFilter = Array("IBLOCK_ID"=>10, "ACTIVE"=>"Y", "PROPERTY_city"=>5744, ">=PROPERTY_startdate" => ConvertDateTime(date($DB->DateFormatToPHP(CSite::GetDateFormat("SHORT")), time()), "YYYY-MM-DD", "ru"));
			$sch_in_spb = CIBlockElement::GetList($arOrder, $arFilter, $arGroupBy, false, $arSelectFields);
			$arFilter = Array("IBLOCK_ID"=>10, "ACTIVE"=>"Y", "PROPERTY_city"=>5745, ">=PROPERTY_startdate" => ConvertDateTime(date($DB->DateFormatToPHP(CSite::GetDateFormat("SHORT")), time()), "YYYY-MM-DD", "ru"));
			$sch_in_kiev = CIBlockElement::GetList($arOrder, $arFilter, $arGroupBy, false, $arSelectFields);
			$arFilter = Array("IBLOCK_ID"=>10, "ACTIVE"=>"Y", "PROPERTY_city"=>5746, ">=PROPERTY_startdate" => ConvertDateTime(date($DB->DateFormatToPHP(CSite::GetDateFormat("SHORT")), time()), "YYYY-MM-DD", "ru"));
			$sch_in_odessa = CIBlockElement::GetList($arOrder, $arFilter, $arGroupBy, false, $arSelectFields);
			$arFilter = Array("IBLOCK_ID"=>10, "ACTIVE"=>"Y", "PROPERTY_city"=>5747, ">=PROPERTY_startdate" => ConvertDateTime(date($DB->DateFormatToPHP(CSite::GetDateFormat("SHORT")), time()), "YYYY-MM-DD", "ru"));
			$sch_in_dnepr = CIBlockElement::GetList($arOrder, $arFilter, $arGroupBy, false, $arSelectFields);
			$arFilter = Array("IBLOCK_ID"=>10, "ACTIVE"=>"Y", "PROPERTY_city"=>14909, ">=PROPERTY_startdate" => ConvertDateTime(date($DB->DateFormatToPHP(CSite::GetDateFormat("SHORT")), time()), "YYYY-MM-DD", "ru"));
			$sch_in_online = CIBlockElement::GetList($arOrder, $arFilter, $arGroupBy, false, $arSelectFields);

            $arGroupBy  = Array();$arOrder = Array();
	      	$arSelectFields = Array("ID");
			$arFilter = Array("IBLOCK_ID"=>9, "ACTIVE"=>"Y", "PROPERTY_city"=>5741, ">=PROPERTY_startdate" => ConvertDateTime(date($DB->DateFormatToPHP(CSite::GetDateFormat("SHORT")), time()), "YYYY-MM-DD", "ru"));
			$res_in_moscow = CIBlockElement::GetList($arOrder, $arFilter, $arGroupBy, false, $arSelectFields);
			$arFilter = Array("IBLOCK_ID"=>9, "ACTIVE"=>"Y", "PROPERTY_city"=>5742, ">=PROPERTY_startdate" => ConvertDateTime(date($DB->DateFormatToPHP(CSite::GetDateFormat("SHORT")), time()), "YYYY-MM-DD", "ru"));
			$res_in_omsk = CIBlockElement::GetList($arOrder, $arFilter, $arGroupBy, false, $arSelectFields);
			$arFilter = Array("IBLOCK_ID"=>9, "ACTIVE"=>"Y", "PROPERTY_city"=>5744, ">=PROPERTY_startdate" => ConvertDateTime(date($DB->DateFormatToPHP(CSite::GetDateFormat("SHORT")), time()), "YYYY-MM-DD", "ru"));
			$res_in_spb = CIBlockElement::GetList($arOrder, $arFilter, $arGroupBy, false, $arSelectFields);
			$arFilter = Array("IBLOCK_ID"=>9, "ACTIVE"=>"Y", "PROPERTY_city"=>5745, ">=PROPERTY_startdate" => ConvertDateTime(date($DB->DateFormatToPHP(CSite::GetDateFormat("SHORT")), time()), "YYYY-MM-DD", "ru"));
			$res_in_kiev = CIBlockElement::GetList($arOrder, $arFilter, $arGroupBy, false, $arSelectFields);
			$arFilter = Array("IBLOCK_ID"=>9, "ACTIVE"=>"Y", "PROPERTY_city"=>5746, ">=PROPERTY_startdate" => ConvertDateTime(date($DB->DateFormatToPHP(CSite::GetDateFormat("SHORT")), time()), "YYYY-MM-DD", "ru"));
			$res_in_odessa = CIBlockElement::GetList($arOrder, $arFilter, $arGroupBy, false, $arSelectFields);
			$arFilter = Array("IBLOCK_ID"=>9, "ACTIVE"=>"Y", "PROPERTY_city"=>5747, ">=PROPERTY_startdate" => ConvertDateTime(date($DB->DateFormatToPHP(CSite::GetDateFormat("SHORT")), time()), "YYYY-MM-DD", "ru"));
			$res_in_dnepr = CIBlockElement::GetList($arOrder, $arFilter, $arGroupBy, false, $arSelectFields);
			$arFilter = Array("IBLOCK_ID"=>9, "ACTIVE"=>"Y", "PROPERTY_city"=>14909, ">=PROPERTY_startdate" => ConvertDateTime(date($DB->DateFormatToPHP(CSite::GetDateFormat("SHORT")), time()), "YYYY-MM-DD", "ru"));
			$res_in_online = CIBlockElement::GetList($arOrder, $arFilter, $arGroupBy, false, $arSelectFields);

		}?>
			<?}
			// начинаем буферизирование вывода
			if($obCache->StartDataCache()) {
			// записываем предварительно буферизированный вывод в файл кеша
			// вместе с дополнительной переменной
			$obCache->EndDataCache(array(
				"sch_in_moscow"    => $sch_in_moscow,
				"sch_in_omsk"    => $sch_in_omsk,
				"sch_in_spb"    => $sch_in_spb,
				"sch_in_kiev"    => $sch_in_kiev,
				"sch_in_odessa"    => $sch_in_odessa,
				"sch_in_dnepr"    => $sch_in_dnepr,
				"sch_in_online"    => $sch_in_online,
				"res_in_moscow"    => $res_in_moscow,
				"res_in_omsk"    => $res_in_omsk,
				"res_in_spb"    => $res_in_spb,
				"res_in_kiev"    => $res_in_kiev,
				"res_in_odessa"    => $res_in_odessa,
				"res_in_dnepr"    => $res_in_dnepr,
				"res_in_online"    => $res_in_online,
			));
			}

            //iwrite($res_in_online);
			?>


<script type="text/javascript">
$(document).ready(function(){
   $(".block_border a").attr("target","_blank");

    $('.block_border a[href]').each(function(i){
		var currHref = $(this).attr("href");
//alert(currHref);
		 $(this).attr('href', function(i, h) {
			return h + (h.indexOf('?') != -1 ? "&r1=fsb&r2=schedule" : "?r1=fsb&r2=schedule");
		});
   });
   /*
   $(".block_border a").attr('href', function(i, h) {
     return h + (h.indexOf('?') != -1 ? "&r1=fsb&r2=schedule" : "?r1=fsb&r2=schedule");
   });
   */
});
</script>



<?
//$id_city ="5741" //Москва
/*
5742  - омск
5744  - спб
5745  - киев
5746  - одесса
5747   - днепр
14909 - онлайн

*/
?>
<div id="showcalendar"  class="usual">
	<div class="inside">
		<div class="cities">
			<ul class="">
			<? if (($id_type <> 3) and  ($bOnline === false)) {?>
				<li>

					<? if ($id_type==2) {?>
						<? if ($res_in_moscow > 0) {?>
							<a href="index.html?city=moscow<? if (isset($_GET['type'])) {?>&type=<?=$_GET['type']?><? }?>" class="<?if ($id_city==5741){?>selected<? } ?>">Москва</a>
						<? } else {?>
						    <a class="without" href="#">Москва</a>
						<? }?>
					<? } ?>
				</li>
				<li>
					<? if ($id_type==2) {?>
						<? if ($res_in_spb > 0) {?>
							<a href="index.html?city=spb<? if (isset($_GET['type'])) {?>&type=<?=$_GET['type']?><? }?>" class="<?if ($id_city==5744){?>selected<? } ?>">С.-Петербург</a>
						<? } else {?>
						    <a class="without" href="#">Санкт-Петербург</a>
						<? }?>
					<? } ?>
				</li>
				<li>
					<? if ($id_type==2) {?>
						<? if ($res_in_omsk > 0) {?>
							<a href="index.html?city=omsk<? if (isset($_GET['type'])) {?>&type=<?=$_GET['type']?><? }?>" class="<?if ($id_city==5742){?>selected<? } ?>">Омск</a>
						<? } else {?>
						    <a class="without" href="#">Омск</a>
						<? }?>
					<? } ?>
				</li>
				<li>

					<? if ($id_type==2) {?>
						<? if ($res_in_kiev > 0) {?>
							<a href="index.html?city=kiev<? if (isset($_GET['type'])) {?>&type=<?=$_GET['type']?><? }?>" class="<?if ($id_city==5745){?>selected<? } ?>" >Киев</a>
							<? } else {?>
							<a class="without" href="#">Киев</a>
							<? } ?>
					<? } ?>
				</li>
				<li>

					<? if ($id_type==2) {?>
						<? if ($res_in_odessa > 0) {?>
							<a href="index.html?city=odessa<? if (isset($_GET['type'])) {?>&type=<?=$_GET['type']?><? }?>" class="<?if ($id_city==5746){?>selected<? } ?>">Одесса</a>
							<? } else {?>
							<a class="without" href="#">Одесса</a>
							<? }?>
					<? } ?>
				</li>
				<li>

					<? if ($id_type==2) {?>
						<? if ($res_in_dnepr > 0) {?>
							<a href="index.html?city=dnepr<? if (isset($_GET['type'])) {?>&type=<?=$_GET['type']?><? }?>"  class="<?if ($id_city==5747){?>selected<? } ?>">Днепропетровск</a>
						<? } else {?>
							<a class="without" href="#">Днепропетровск</a>
						<? }?>
					<? } ?>
				</li>

				<? } ?>

			</ul>
		</div>
        <div class="clear"> </div>
		<div class="block_border">
			<? if ($id_type==2) {?>
				<? if (isset($_GET["by_date"])) { ?>
					<?$APPLICATION->IncludeComponent("edu:events.calendar.custom", "edu_calendar_trainings_by_cat", Array(
						"IBLOCK_TYPE"	=>	"edu",
						"PROPERTY_CITYCHECK"	=>	$id_city,
						"IBLOCK_ID"	=>	$ID_IBLOCK, /*"9",*/
						"MONTH_VAR_NAME"	=>	"month",
						"YEAR_VAR_NAME"	=>	"year",
						"WEEK_START"	=>	"1",
						"SHOW_YEAR"	=>	"N",
						"SHOW_TIME"	=>	"N",
						"TITLE_LEN"	=>	"200",
						"SHOW_CURRENT_DATE"	=>	"Y",
						"SHOW_MONTH_LIST"	=>	"N",
						"NEWS_COUNT"	=>	"0",
						"DETAIL_URL"	=>	"news_detail.php?ID=#ELEMENT_ID#",
						"AJAX_MODE"	=>	"Y",
						"AJAX_OPTION_SHADOW"	=>	"Y",
						"AJAX_OPTION_JUMP"	=>	"N",
						"AJAX_OPTION_STYLE"	=>	"Y",
						"AJAX_OPTION_HISTORY"	=>	"N",
						"CACHE_TYPE"	=>	"A",
						"CACHE_TIME"	=>	"3600",
						"DATE_FIELD"	=>	"PROPERTY_STARTDATE",
						"TYPE"	=>	"EVENTS",
						"SET_TITLE"	=>	"N"
						)
					);?>
				<? } else {
						$data  = date("Y-m-d");
						$GLOBALS["arrFilter"] =array("PROPERTY_city" => $id_city, "ACTIVE" => "Y" ,">=PROPERTY_startdate" => $data);
						$APPLICATION->IncludeComponent(
							"bitrix:news.list",
							"edu_ru_all_city_schedule_rss",
							Array(
							"IBLOCK_TYPE" => "edu",	// Тип информационного блока (используется только для проверки)
							"IBLOCK_ID" => "9",	// Код информационного блока
							"NEWS_COUNT" => "100",	// Количество новостей на странице
							"SORT_BY1" => "PROPERTY_startdate",	// Поле для первой сортировки новостей
							"SORT_ORDER1" => "ASC",	// Направление для первой сортировки новостей
							"SORT_BY2" => "SORT",	// Поле для второй сортировки новостей
							"SORT_ORDER2" => "ASC",	// Направление для второй сортировки новостей
							"FILTER_NAME" => "arrFilter",	// Фильтр
							"FIELD_CODE" => array(	// Поля
								0 => "",
								1 => "",
							),
							"SHOW_PRICE" => $_SESSION['SHOW_PRICE'],
							"PROPERTY_CODE" => array(	// Свойства
								0 => "course_сode",
								1 => "startdate",
								2 => "enddate",
								3 => "schedule_time",
								4 => "schedule_description",
								5 => "schedule_price",
								6 => "schedule_duration",
								7 => "hot_checkbox",
								8 => "prschedule_startdate",
								9 => "prschedule_enddate",
								10 => "prschedule_time",
								11 => "prschedule_desc",
								12 => "",
							),
							"CHECK_DATES" => "Н",	// Показывать только активные на данный момент элементы
							"DETAIL_URL" => "/edu/catalog/course.html?ID=#ELEMENT_ID#",	// URL страницы детального просмотра (по умолчанию - из настроек инфоблока)
							"AJAX_MODE" => "N",	// Включить режим AJAX
							"AJAX_OPTION_SHADOW" => "Y",	// Включить затенение
							"AJAX_OPTION_JUMP" => "N",	// Включить прокрутку к началу компонента
							"AJAX_OPTION_STYLE" => "Y",	// Включить подгрузку стилей
							"AJAX_OPTION_HISTORY" => "N",	// Включить эмуляцию навигации браузера
							"CACHE_TYPE" => "A",	// Тип кеширования
							"CACHE_TIME" => "3600",	// Время кеширования (сек.)
							"CACHE_FILTER" => "Y",	// Кэшировать при установленном фильтре
							"PREVIEW_TRUNCATE_LEN" => "",	// Максимальная длина анонса для вывода (только для типа текст)
							"ACTIVE_DATE_FORMAT" => "d.m.Y",	// Формат показа даты
							"DISPLAY_PANEL" => "N",	// Добавлять в админ. панель кнопки для данного компонента
							"SET_TITLE" => "N",	// Устанавливать заголовок страницы
							"INCLUDE_IBLOCK_INTO_CHAIN" => "N",	// Включать инфоблок в цепочку навигации
							"ADD_SECTIONS_CHAIN" => "N",	// Включать раздел в цепочку навигации
							"HIDE_LINK_WHEN_NO_DETAIL" => "N",	// Скрывать ссылку, если нет детального описания
							"PARENT_SECTION" => "",	// ID раздела
							"PARENT_SECTION_CODE" => "",	// Код раздела
							"DISPLAY_TOP_PAGER" => "N",	// Выводить над списком
							"DISPLAY_BOTTOM_PAGER" => "N",	// Выводить под списком
							"PAGER_TITLE" => "",	// Название категорий
							"PAGER_SHOW_ALWAYS" => "N",	// Выводить всегда
							"PAGER_TEMPLATE" => "",	// Название шаблона
							"PAGER_DESC_NUMBERING" => "N",	// Использовать обратную навигацию
							"PAGER_DESC_NUMBERING_CACHE_TIME" => "36000",	// Время кеширования страниц для обратной навигации
							"DISPLAY_DATE" => "N",
							"DISPLAY_NAME" => "Y",
							"DISPLAY_PICTURE" => "N",
							"DISPLAY_PREVIEW_TEXT" => "N",
							"AJAX_OPTION_ADDITIONAL" => "",	// Дополнительный идентификатор
							)
						);?>
	            <? } ?>

			<? } ?>


		</div>
	</div>
</div>


<blockquote>
	<p>По запросу на <a href="mailto:<?=EMAIL_ADDRESS?>" title="Написать письмо"><?=EMAIL_ADDRESS?></a> мы готовы выслать резюме Инструктора, читающего интересующий Вас курс, а также ответить на любые дополнительные вопросы касательно обучения в нашем Учебном Центре.</p>
</blockquote>

</body>
</html>
<?
require($_SERVER["DOCUMENT_ROOT"]."/bitrix/modules/main/include/epilog_after.php");
?>
